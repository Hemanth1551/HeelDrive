<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="ss1.css">
    <script src="https://kit.fontawesome.com/179f43bc7a.js" crossorigin="anonymous"></script>
	<script src="https://unpkg.com/phosphor-icons"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500&display=swap">
    
	<title>User Product Tab</title>
    <style>
       /* General Styles */
.filter-form {
    font-family: Arial, sans-serif;
    background: transparent;
    color: white;
    padding: 15px;
    border-radius: 8px;
    width: 220px;
    height: 450px;
    display: flex;
    flex-direction: column;
    gap: 10px;
    overflow-y: scroll;
}

/* Filter Section */
.filter-section {
    background: transparent;
    padding: 10px;
    border-radius: 5px;
    /* border: 1px solid #ddd; */
    color: white;
}

/* Section Headers */
.filter-header {
    font-size: 16px;
    margin: 0;
    /* padding: 8px; */
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    align-items: center;
    color: white;
    font-weight: bold;
}

/* Filter Content */
.filter-content {
    display: none;
    padding: 8px;
}

/* Labels */
.filter-content label {
    display: block;
    padding: 5px 0;
    font-size: 14px;
    cursor: pointer;
}

/* Checkbox and Radio Inputs */
.filter-content input {
    margin-right: 8px;
    transform: scale(1.1);
    cursor: pointer;
}

/* Arrow Icon Rotation */
.toggle-icon {
    transition: transform 0.3s ease;
}

/* When Section is Open */
.filter-section.open .filter-content {
    display: block;
}

.filter-section.open .toggle-icon {
    transform: rotate(180deg);
}





/* Style the Filter Tab */
.filtertab {
    position: absolute;
    right: 20px;
    top: 45%;
    display: none;
    height: 300px;
    width: 250px;
    /* height: 100vh; */
    background: rgb(50, 50, 50);
    color: black;
    box-shadow: 2px 0 10px rgba(0, 0, 0, 0.2);
    padding: 20px;
    transition: left 0.3s ease;
    z-index: 2;
    overflow-y: scroll;
}

/* Show Filter Tab when Active */
.filtertab.active {
    /* left: 300px; */
    /* right: 0;
    top: 55%; */
    display: block;
    z-index: 2;
}

/* Icon Button Styling */
/* .icon-button {

    background: #333;
    color: white;
    border: none;
    padding: 10px 12px;
    font-size: 18px;
    border-radius: 5px;
    cursor: pointer;
    transition: background 0.3s;
} */

.icon-button:hover {
    background: #555;
}


@media (max-width: 426px){
    .filtertab{
        top: 35%;
        right: 10px;

    }
}
@media (min-width: 1440px){
    
    .filtertab{
        display: none;
    }
}


    </style>
</head>
<body style="background-color: black;">

	<div class="app">
		<header class="app-header">
			<div class="app-header-logo">
				<div class="logo">
					<span class="logo-icon">
						<img src="/images/logo.png" />
					</span>
					<h1 class="logo-title">
						<span>Heel_Drive</span>
						<span>Shoes</span>
					</h1>
				</div>
			</div>
			<div class="app-header-navigation">
				<div class="tabs">
					<a href="userproducts.html" class="active">
						Products
					</a>
					<a href="useraddress.html">
						Address
					</a>
					<a href="userorder.html">
						Orders
					</a>
					<a href="usercart.html">
						Cart
					</a>
					<a href="userprofile.html">
						Your Profile
					</a>
				</div>
			</div>
			
			<div id="mapDiv" style="
            align-items: center;
            text-align: center;
            display: none; position: absolute; background-color: rgb(50, 50, 50); height: 300px; width: 400px; top: 150px; right: 0; z-index: 2;">
                <div class="tabs" style="display: block;">
					<a href="userproducts.html" class="active">
						Products
					</a><br>
					<a href="useraddress.html">
						Address
					</a><br>
					<a href="userorder.html">
						Orders
					</a><br>
					<a href="usercart.html">
						Cart
					</a><br>
					<a href="userprofile.html">
						Your Profile
					</a>
				</div>
            </div>
			
			<div class="app-header-actions">
				<button class="user-profile">
					<span id="usname"></span>
					<span>
						<img src="" id="usprofile"/>
					</span>
				</button>
				<div class="app-header-actions-buttons">
				</div>
			</div>
			<div class="app-header-mobile">
				<button class="icon-button large" onclick="showmap()">
					<i class="ph-list"></i>
				</button>
			</div>
	
		</header>
		<div class="app-body">
			<div class="app-body-navigation">
				<nav class="navigation">


					<form class="filter-form" id="filterForm">
                        <div class="filter-section">
                            <h3 class="filter-header">Gender <i class="fa-solid fa-chevron-down toggle-icon"></i></h3>
                            <div class="filter-content">
                                <label><input type="checkbox" name="gender" value="Men"> Men</label>
						        <label><input type="checkbox" name="gender" value="Women"> Women</label>
						        <label><input type="checkbox" name="gender" value="Kids"> Kids</label>
                                <label><input type="checkbox" name="gender" value="Unisex"> Unisex</label>    
                            </div>
                        </div>
                    
                        <div class="filter-section">
                            <h3 class="filter-header">Price <i class="fa-solid fa-chevron-down toggle-icon"></i></h3>
                            <div class="filter-content">
                                <label><input type="checkbox" name="price" value="1500-3000"> 1500 to 3000</label>
                                <label><input type="checkbox" name="price" value="3000-6000"> 3000 to 6000</label>
                            </div>
                        </div>
                        
                        <div class="filter-section">
                            <h3 class="filter-header">Category <i class="fa-solid fa-chevron-down toggle-icon"></i></h3>
                            <div class="filter-content">
                                <label><input type="checkbox" name="category" value="Running"> Running</label>
						        <label><input type="checkbox" name="category" value="Sport"> Sport</label>
						        <label><input type="checkbox" name="category" value="Casual"> Casual</label>
						        <label><input type="checkbox" name="category" value="Lifestyle"> Style</label>
						        <label><input type="checkbox" name="category" value="Exercise"> Exercise</label>
						        <label><input type="checkbox" name="category" value="Sneakers"> Sneakers</label>
						        <label><input type="checkbox" name="category" value="Family"> Family</label>
						        
                            </div>
                        </div>
                    
                        <div class="filter-section">
                            <h3 class="filter-header">Color <i class="fa-solid fa-chevron-down toggle-icon"></i></h3>
                            <div class="filter-content">
                                <label><input type="checkbox" name="color" value="white"> White</label>
						        <label><input type="checkbox" name="color" value="black"> Black</label>
						        <label><input type="checkbox" name="color" value="blue"> Blue</label>
						        <label><input type="checkbox" name="color" value="brown"> Brown</label>
						        <label><input type="checkbox" name="color" value="red"> Red</label>
                            </div>
                        </div>
                    
                        <div class="filter-section">
                            <h3 class="filter-header">Size <i class="fa-solid fa-chevron-down toggle-icon"></i></h3>
                            <div class="filter-content">
                                <!-- <label><input type="checkbox" name="size" value="6"> 6</label>
                                <label><input type="checkbox" name="size" value="7"> 7</label>
                                <label><input type="checkbox" name="size" value="8"> 8</label>
                                <label><input type="checkbox" name="size" value="9"> 9</label>
                                <label><input type="checkbox" name="size" value="10"> 10</label>-->
                                <label><input type="checkbox" name="size" value="6"> Small (6)</label>
						        <label><input type="checkbox" name="size" value="7"> Small (7)</label>
						        <label><input type="checkbox" name="size" value="8"> Medium (8)</label>
						        <label><input type="checkbox" name="size" value="9"> Medium (9)</label>
						        <label><input type="checkbox" name="size" value="10"> Large (10)</label>
						        <label><input type="checkbox" name="size" value="11"> Large (11)</label>
						        <label><input type="checkbox" name="size" value="12">Extra Large (12)</label>
                            </div>
                        </div>
                    
                        <div class="filter-section">
                            <h3 class="filter-header">Sort By <i class="fa-solid fa-chevron-down toggle-icon"></i></h3>
                            <div class="filter-content">
                                <label><input type="radio" name="sort" value="lth"> Low to High</label><br>
						        <label><input type="radio" name="sort" value="htl"> High to Low</label><br>
                            </div>
                        </div>
                    </form>
                    


					
				</nav>
				<footer class="footer">
					<h1 style="font-weight:bold; color : white;" >Heel Drive<small>Â©</small></h1>
					<div>
						Heel Drive Â©<br />
						All Rights Reserved 2025
					</div>
				</footer>
			</div>
			<div class="app-body-main-content">
                <section class="service-section">
                    <div class="transfer-section-header">
                        <h2 style="color: white; font-weight: bold; margin-top: -10px;">Product Details</h2>

                        <div class="filtertab">
                            
                            <form class="filter-form" id="filterForm">
                        <div class="filter-section">
                            <h3 class="filter-header">Gender <i class="fa-solid fa-chevron-down toggle-icon"></i></h3>
                            <div class="filter-content">
                                <label><input type="checkbox" name="gender" value="Men"> Men</label>
						        <label><input type="checkbox" name="gender" value="Women"> Women</label>
						        <label><input type="checkbox" name="gender" value="Kids"> Kids</label>
                                <label><input type="checkbox" name="gender" value="Unisex"> Unisex</label>    
                            </div>
                        </div>
                    
                        <div class="filter-section">
                            <h3 class="filter-header">Price <i class="fa-solid fa-chevron-down toggle-icon"></i></h3>
                            <div class="filter-content">
                                <label><input type="checkbox" name="price" value="1500-3000"> 1500 to 3000</label>
                                <label><input type="checkbox" name="price" value="3000-6000"> 3000 to 6000</label>
                            </div>
                        </div>
                        
                        <div class="filter-section">
                            <h3 class="filter-header">Category <i class="fa-solid fa-chevron-down toggle-icon"></i></h3>
                            <div class="filter-content">
                                <label><input type="checkbox" name="category" value="Running"> Running</label>
						        <label><input type="checkbox" name="category" value="Sport"> Sport</label>
						        <label><input type="checkbox" name="category" value="Casual"> Casual</label>
						        <label><input type="checkbox" name="category" value="Lifestyle"> Style</label>
						        <label><input type="checkbox" name="category" value="Exercise"> Exercise</label>
						        <label><input type="checkbox" name="category" value="Sneakers"> Sneakers</label>
						        <label><input type="checkbox" name="category" value="Family"> Family</label>
                            </div>
                        </div>
                    
                        <div class="filter-section">
                            <h3 class="filter-header">Color <i class="fa-solid fa-chevron-down toggle-icon"></i></h3>
                            <div class="filter-content">
                                <label><input type="checkbox" name="color" value="white"> White</label>
						        <label><input type="checkbox" name="color" value="black"> Black</label>
						        <label><input type="checkbox" name="color" value="blue"> Blue</label>
						        <label><input type="checkbox" name="color" value="brown"> Brown</label>
						        <label><input type="checkbox" name="color" value="red"> Red</label>
                            </div>
                        </div>
                    
                        <div class="filter-section">
                            <h3 class="filter-header">Size <i class="fa-solid fa-chevron-down toggle-icon"></i></h3>
                            <div class="filter-content">
                                <!-- <label><input type="checkbox" name="size" value="6"> 6</label>
                                <label><input type="checkbox" name="size" value="7"> 7</label>
                                <label><input type="checkbox" name="size" value="8"> 8</label>
                                <label><input type="checkbox" name="size" value="9"> 9</label>
                                <label><input type="checkbox" name="size" value="10"> 10</label>-->
                                <label><input type="checkbox" name="size" value="6"> Small (6)</label>
						        <label><input type="checkbox" name="size" value="7"> Small (7)</label>
						        <label><input type="checkbox" name="size" value="8"> Medium (8)</label>
						        <label><input type="checkbox" name="size" value="9"> Medium (9)</label>
						        <label><input type="checkbox" name="size" value="10"> Large (10)</label>
						        <label><input type="checkbox" name="size" value="11"> Large (11)</label>
						        <label><input type="checkbox" name="size" value="12">Extra Large (12)</label>
                            </div>
                        </div>
                    
                        <div class="filter-section">
                            <h3 class="filter-header">Sort By <i class="fa-solid fa-chevron-down toggle-icon"></i></h3>
                            <div class="filter-content">
                                <label><input type="radio" name="sort" value="lth"> Low to High</label><br>
						        <label><input type="radio" name="sort" value="htl"> High to Low</label><br>
                            </div>
                        </div>
                    </form>

                            



                        </div>
                        <div class="filter-options">
                            <p>Filter selected: more than 100 $</p>

                            <button class="icon-button" title="Logout" onclick="logout()">
                                <i class="ph ph-sign-out"></i>
                            </button>
                            <button class="icon-button">
                                <i class="ph-plus"></i>
                            </button>
                        </div>
                    </div>
                    <div class="transfers" style="height: 550px;">



                        <section class="section-products">
                            <div class="container">
                                    <div class="row" id="row">
                                            <!-- Single Product -->
                                       <div class="col-md-6 col-lg-4 col-xl-3">
                                       		<div id="product-1" class="single-product" >
                                            	<div class="part-1" >
	                                             	<ul>
	                                                      <li><a href="#"><i class="fas fa-shopping-cart"></i></a></li>
	                                                      <li><a href="#"><i class="fas fa-heart"></i></a></li>
	                                                      <li><a href="#"><i class="fas fa-plus"></i></a></li>
	                                                       <li><a href="#"><i class="fas fa-expand"></i></a></li>
	                                               </ul>                                                                  
                                           </div>
                                           <div class="part-2">
	                                           <label class="product-title">Here Product Title</label><br>
	                                           <label class="product-old-price">$79.99</label><br>
	                                           <label class="product-price">$49.99</label>
                                           </div> 
                                    	</div>
                                    </div>
                                    
                                        <script>
                                        
                                        let userId;
                                        let allProducts = []; // Global variable to store products
                                     // Read from URL only once (globally)
                                        let categoryFromURL;
                                        
                                        //console.log(filter)
                                        
                                        function getUserid() {
                                            return fetch("http://localhost:8081/api/session-userid", {
                                                method: "GET",
                                                credentials: "include", // Ensures cookies (session) are sent
                                                headers: { "Content-Type": "application/json" }
                                            })
                                            .then(response => {
                                                if (!response.ok) throw new Error("Session error");
                                                return response.json();
                                            })
                                            .then(uservalidid => {
                                                userId = uservalidid;
                                                //console.log("â User ID retrieved:", userId);
                                            })
                                            .catch(error => {
                                                console.error("â Error retrieving session:", error);
                                                alert("Session expired. Please log in again.");
                                            });
                                        }
				
                                        function viewProducts() {
                                            if (!userId) {
                                                console.log("â³ Waiting for userId...");
                                                getUserid().then(() => {
                                                    console.log("â User ID retrieved:", userId);
                                                });
                                            } else {
                                                fetchProducts(); // If userId is already set, call fetchProducts immediately
                                            }
                                        }
                                        
                                        
                                        

                                        function fetchProducts() {
                                            fetch('getAllProductsWithImages') // Update this with your actual API endpoint
                                                .then(response => response.json())
                                                .then(products => {
                                                    console.log(products);
                                                    allProducts = products; // Store globally
                                                    if (!categoryFromURL) {
                                                    	console.log("ddd", categoryFromURL)
                                                    	displayProducts(products);
                                                    } else {
                                                        console.log("Not empty");
                                                    }
                                                    //displayProducts(products);
                                                    setupFilters(); // Set up filters dynamically
                                                })
                                                .catch(error => console.error("Error fetching products:", error));
                                        }
                                        
                                        

                                        function displayProducts(filteredProducts) {
                                            const productList = document.getElementById("row");
                                            productList.innerHTML = ""; // Clear previous products

                                            if (filteredProducts.length === 0) {
                                                productList.innerHTML = "<p>No products found.</p>";
                                                return;
                                            }

                                            filteredProducts.forEach(product => {
                                            	const productDiv = document.createElement('div');
                                                productDiv.classList.add('col-md-6', 'col-lg-4', 'col-xl-3');

                                                productDiv.innerHTML = `
                                                    <div id="product-${product.id}" class="single-product">
                                                        <div class="part-1" style="background-image: url('${product.firstImageUrl}'); background-size: cover; ">
                                                            <ul>
                                                                <li><a onclick="askQuantityThenProceed(${product.id}, ${product.offerPrice})"><i class="fas fa-shopping-cart"></i></a></li>
                                                                <li><a href="#"><i class="fas fa-heart"></i></a></li>
                                                                <li><a onclick="askQuantityThenProceedToCart(${product.id})"><i class="fas fa-plus"></i></a></li>
                                                                <li><a href="usersingleproduct.html?id=${product.id}"><i class="fas fa-expand"></i></a></li>
                                                            </ul>
                                                        </div>
                                                        <div class="part-2">
                                                            <label class="product-title">${product.productName}</label><br>
                                                            <label class="product-old-price">â¹${product.oldPrice}</label><br>
                                                            <label class="product-price">â¹${product.offerPrice}</label>
                                                        </div>
                                                    </div>
                                                `;


                                                productList.appendChild(productDiv);
                                            });
                                        }

                                        
                                        window.addEventListener('DOMContentLoaded', () => {
                                            const params = new URLSearchParams(window.location.search);
                                            categoryFromURL = params.get('category');

                                            if (categoryFromURL) {
                                                // Check the matching checkbox
                                                const checkbox = document.querySelector(`input[name="category"][value="${categoryFromURL}"]`);
                                                if (checkbox) {
                                                    checkbox.checked = true;
                                                }

                                                // Fetch products, then filter
                                                fetch('getAllProductsWithImages') // Replace with your actual API
                                                    .then(response => response.json())
                                                    .then(products => {
                                                        const allPp = products;

                                                        // Filter products that exactly match the category
                                                        const filpro = allPp.filter(product => product.category === categoryFromURL);

                                                        console.log("All products:", allPp);
                                                        console.log("Selected category:", categoryFromURL);
                                                        console.log("Filtered products:", filpro);

                                                        displayProducts(filpro);
                                                    })
                                                    .catch(error => console.error("Error fetching products:", error));
                                            }
                                        });

                                        
                                        
                                        function applyFilters() {
                                            const selectedGenders = Array.from(document.querySelectorAll("input[name='gender']:checked")).map(input => input.value);
                                            const selectedPrices = Array.from(document.querySelectorAll("input[name='price']:checked")).map(input => input.value);
                                            const selectedColors = Array.from(document.querySelectorAll("input[name='color']:checked")).map(input => input.value.toLowerCase());
                                            const selectedSizes = Array.from(document.querySelectorAll("input[name='size']:checked")).map(input => input.value);
                                            const selectedCategories = Array.from(document.querySelectorAll("input[name='category']:checked")).map(input => input.value);
                                            const selectedSort = document.querySelector("input[name='sort']:checked")?.value;

                                            let filteredProducts = allProducts.filter(product => {
                                                return (
                                                    (selectedGenders.length === 0 || selectedGenders.includes(product.gender)) &&
                                                    (selectedPrices.length === 0 || selectedPrices.some(priceRange => {
                                                        let [min, max] = priceRange.split("-").map(Number);
                                                        return Number(product.offerPrice) >= min && Number(product.offerPrice) <= max;
                                                    })) &&
                                                    (selectedColors.length === 0 || selectedColors.includes(product.color.toLowerCase())) &&
                                                    (selectedSizes.length === 0 || selectedSizes.includes(product.size)) &&
                                                    (selectedCategories.length === 0 || selectedCategories.includes(product.category))
                                                );
                                            });

                                            if (selectedSort === "lth") {
                                                filteredProducts.sort((a, b) => Number(a.offerPrice) - Number(b.offerPrice));
                                            } else if (selectedSort === "htl") {
                                                filteredProducts.sort((a, b) => Number(b.offerPrice) - Number(a.offerPrice));
                                            }

                                            displayProducts(filteredProducts);
                                        }


                                        function setupFilters() {
                                            document.querySelectorAll(".filter-form input").forEach(input => {
                                                input.addEventListener("change", applyFilters);
                                            });
                                        }
											
                                        function askQuantityThenProceed(productId, offerPrice) {
                                            let quantity = prompt("Enter quantity:", "1");

                                            // Ensure the quantity is a valid number and greater than zero
                                            if (quantity !== null && !isNaN(quantity) && quantity > 0) {
                                              proceedToPayment(productId, offerPrice, parseInt(quantity));
                                            } else {
                                              alert("Please enter a valid quantity.");
                                            }
                                          }
                                        
                                        function proceedToPayment(productId, price, quantity) {
                                            // Redirect to payment page with URL parameters
                                            window.location.href = `useraddress.html?productId=${productId}&price=${price}&quantity=${quantity}`;
                                        }
                                        
                                        function askQuantityThenProceedToCart(productId) {
                                            let quantity = prompt("Enter quantity:", "1");

                                            // Ensure the quantity is a valid number and greater than zero
                                            if (quantity !== null && !isNaN(quantity) && quantity > 0) {
                                              AddToCart(productId, parseInt(quantity));
                                            } else {
                                              alert("Please enter a valid quantity.");
                                            }
                                        }
                                        
                                        function AddToCart(productId, quantity){
                                        	const cartData = {
                                        			userid: userId,  // Make sure `userId` is defined before this call
                                        		    productid: productId,  // Example product ID
                                        		    quantity: quantity,
                                        	};
                                        	fetch("http://localhost:8081/api/cart", {  // Update the URL if needed
                                                method: "POST",
                                                credentials: "include",  // Ensures cookies/session are sent
                                                headers: {
                                                    "Content-Type": "application/json"
                                                },
                                                body: JSON.stringify(cartData) // Convert JS object to JSON string
                                            })
                                            .then(response => {
                                                if (!response.ok) {
                                                    throw new Error("Failed to save cart data");
                                                }
                                                return response.json();
                                            })
                                            .then(savedCart => {
                                                console.log("â Cart saved successfully:", savedCart);
                                                alert("Cart item added successfully!");
                                            })
                                            .catch(error => {
                                                console.error("â Error saving cart:", error);
                                                alert("Error adding item to cart. Please try again.");
                                            });
                                        }
                                        
                                        
                                        
                                   
                                  
                                        //fetchProducts();
					
                                        //viewProducts();
									</script>
                                    
                                 </div>
                            </div>
                        </section>
                    </div>
                </section>
            </div>
			<div class="app-body-sidebar">

			</div>

            
		</div>

        
	</div>
    <script>
        document.querySelectorAll(".filter-header").forEach(header => {
            header.addEventListener("click", () => {
                let parent = header.parentElement;
                parent.classList.toggle("open");
            });
        });

        // document.getElementById("icon-button").addEventListener("click", function () {
        //     document.querySelector(".filtertab").classList.toggle("active");
        // });

        function toggleFilter() {
            if (window.innerWidth <= 1440) { 
                document.querySelector(".filtertab").classList.toggle("active");
            }
        }

        // Add event listener
        //document.getElementById("icon-button").addEventListener("click", toggleFilter);

        // Listen for window resize to recheck conditions
        window.addEventListener("resize", function () {
            if (window.innerWidth > 1440) {
                document.querySelector(".filtertab").classList.remove("active"); // Hide if resizing back to large screen
            }
        });
        
        
        
        function showmap() {
            const mapDiv = document.getElementById("mapDiv");
            if (mapDiv.style.display === "none" || mapDiv.style.display === "") {
                mapDiv.style.display = "block";
            } else {
                mapDiv.style.display = "none";
            }
        }
        
        let userdata = {};

    	  async function fetchUserInfo() {
    	    try {
    	      const adminRes = await fetch('/api/userinfo');

    	      if (!adminRes.ok) {
    	        throw new Error('Failed to fetch admin info');
    	      }

    	      const data = await adminRes.json();

    	      
    	      // Update DOM
    	      document.getElementById("usname").innerText = data.name;
    	      document.getElementById("usprofile").src = `/api/getUserImage/${data.id}`;

    	      console.log("User Data:", data);

    	    } catch (error) {
    	      console.error('Error fetching admin data:', error.message);
    	    }
    	  }
    	  
    	  
    	  window.addEventListener('DOMContentLoaded', () => {
  			fetch('/api/userinfo')
  		    .then(res => {
  		      if (res.ok) return res.json();
  		      else throw new Error('Not User');
  		    })
  		    .then(user => {
  		      // User is logged in
  		      console.log("Logged in as User:", user.name);
  		    userId = `${user.id}`;
  		      fetchProducts();
			
              viewProducts();

  		      //window.location.href = `/usersingleproduct.html?id=${loc}`;
  		    })
  		    .catch(() => {
  		      // Neither admin nor user logged in
  		      alert("Not logged in. Redirecting to login page.");
  		      window.location.href = '/userlogin.html';
  		    });
  		});

    	  
    	  function logout() {
    		  fetch('/api/logout', {
    		    method: 'POST',
    		    credentials: 'include'  // Important to send session cookie
    		  })
    		    .then(res => {
    		      if (res.ok) return res.text();
    		      else throw new Error('Logout failed');
    		    })
    		    .then(() => {
    		      window.location.href = '/userlogin.html';
    		    })
    		    .catch(() => {
    		      alert("Not logged in. Redirecting to login page.");
    		      window.location.href = '/userlogin.html';
    		    });
    		}
    	  

    	  // Call function on load
    	  fetchUserInfo();

    </script>


</body>
</html>

<style>
    /* .status-active {
	color: green;
	font-weight: bold;
}
.status-inactive {
	color: red;
	font-weight: bold;
} */

@media (min-width: 1025px) and (max-width: 1600px){ 
	.service-section{
		width: 1000px;
	}
	.service-section table{
		width: 1000px;
	}
}


/* Default styles for the table */
.transfers-card {
    width: 100%;
    border-collapse: collapse;
}






@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500&display=swap');

body {
    font-family: "Poppins", sans-serif;
    color: #444444;
}

a,
a:hover {
    text-decoration: none;
    color: inherit;
}

.section-products {
    padding: 80px 0 54px;
}

/* .row{
    display: grid;
    grid-template-columns: repeat(3, 1fr); 
} */

.row {
    display: grid;
    grid-template-columns: repeat(3, 1fr); /* Default: 3 columns */
    gap: 20px; /* Adjusts spacing between grid items */
    z-index: 1;
}

@media (max-width: 1024px) {
    .row {
        grid-template-columns: repeat(2, 0.5fr);
    }
}

/* For medium screens (tablets) - 2 columns */
@media (max-width: 992px) {
    .row {
        grid-template-columns: repeat(2, 1fr);
    }
}

/* For small screens (mobile) - 1 column */
@media (max-width: 576px) {
    .row {
        grid-template-columns: repeat(1, 1fr);
    }
}

.section-products .header {
    margin-bottom: 50px;
}

.section-products .header h3 {
    font-size: 1rem;
    color: #fe302f;
    font-weight: 500;
}

.section-products .header h2 {
    font-size: 2.2rem;
    font-weight: 400;
    color: #444444; 
}

.section-products .single-product {
    margin-bottom: 26px;
    width: 300px;
    height: 400px;
}

.section-products .single-product .part-1 {
    position: relative;
    height: 290px;
    max-height: 290px;
    margin-bottom: 20px;
    overflow: hidden;
}

.section-products .single-product .part-1::before {
		position: absolute;
		content: "";
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		z-index: -1;
		transition: all 0.3s;
}

.section-products .single-product:hover .part-1::before {
		transform: scale(1.2,1.2) rotate(5deg);
}

.section-products .single-product .part-1 .discount,
.section-products .single-product .part-1 .new {
    position: absolute;
    top: 15px;
    left: 20px;
    color: #ffffff;
    background-color: #fe302f;
    padding: 2px 8px;
    text-transform: uppercase;
    font-size: 0.85rem;
}

.section-products .single-product .part-1 .new {
    left: 0;
    background-color: #444444;
}

.section-products .single-product .part-1 ul {
    position: absolute;
    bottom: -41px;
    left: 20px;
    margin: 0;
    padding: 0;
    list-style: none;
    opacity: 0;
    transition: bottom 0.5s, opacity 0.5s;
}

.section-products .single-product:hover .part-1 ul {
    bottom: 30px;
    opacity: 1;
}

.section-products .single-product .part-1 ul li {
    display: inline-block;
    margin-right: 4px;
}

.section-products .single-product .part-1 ul li a {
    display: inline-block;
    width: 40px;
    height: 40px;
    line-height: 40px;
    background-color: #ffffff;
    color: #444444;
    text-align: center;
    box-shadow: 0 2px 20px rgb(50 50 50 / 10%);
    transition: color 0.2s;
}

.section-products .single-product .part-1 ul li a:hover {
    color: #fe302f;
}

.section-products .single-product .part-2{
    color: white;
}
.section-products .single-product .part-2 .product-title {
    font-size: 1rem;
}

.section-products .single-product .part-2 h4 {
    display: inline-block;
    font-size: 1rem;
}

.section-products .single-product .part-2 .product-old-price {
    position: relative;
    padding: 0 7px;
    margin-right: 2px;
    opacity: 0.6;
}

.section-products .single-product .part-2 .product-old-price::after {
    position: absolute;
    content: "";
    top: 50%;
    left: 0;
    width: 100%;
    height: 1px;
    background-color: #444444;
    transform: translateY(-50%);
}
</style>