<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="ss1.css">
    <link rel="stylesheet" href="sicss.css">
	<script src="https://unpkg.com/phosphor-icons"></script>
    <script src="https://kit.fontawesome.com/179f43bc7a.js" crossorigin="anonymous"></script>
	<title>Admin Single Product Tab</title>
</head>
<body>
	<div class="app">
		<header class="app-header">
			<div class="app-header-logo">
				<div class="logo">
					<span class="logo-icon">
						<img src="/images/logo.png"/>
					</span>
					<h1 class="logo-title">
						<span>Heel_Drive</span>
						<span>Shoes</span>
					</h1>
				</div>
			</div>
			<div class="app-header-navigation">
				<div class="tabs">

					<a href="address.html">
						Addess
					</a>
					<a href="card.html">
						Cards
					</a>
					<a href="users.html">
						Users
					</a>
					<a href="order.html">
						Orders
					</a>
					<a href="product.html" class="active">
						Products
					</a>
				</div>
			</div>
			<div class="app-header-actions">
				<button class="user-profile">
					<span id="adminname"></span>
					<span>
						<img src="" id="adminimg"/>
					</span>
				</button>
				<div class="app-header-actions-buttons">
				</div>
			</div>
			<div class="app-header-mobile">
				<button class="icon-button large">
					<i class="ph-list"></i>
				</button>
			</div>
		</header>
		<div class="app-body">
			<div class="app-body-navigation">
				<nav class="navigation">
					<a href="index.html">
						<i class="ph-browsers"></i>
						<span>Dashboard</span>
					</a>
					<a href="address.html">
						<i class="ph ph-house"></i>
						<span>Addess</span>
					</a>
					<a href="card.html">
						<i class="ph ph-credit-card"></i>
						<span>Cards</span>
					</a>
					<a href="users.html">
						<i class="ph ph-user"></i>
						<span>Users</span>
					</a>
					<a href="order.html">
						<i class="ph ph-bag"></i>
						<span>Orders</span>
					</a>
					<a href="product.html">
						<i class="ph ph-package"></i>
						<span>Products</span>
					</a>
					<a href="payment.html">
						<i class="ph ph-currency-inr"></i>
						<span>Payments</span>
					</a>
					<a href="profile.html">
						<i class="ph ph-user-circle"></i>
						<span>Profile</span>
					</a>
				</nav>
				<footer class="footer">
					<h1>Heel Drive<small>©</small></h1>
					<div>
						Heel Drive ©<br />
						All Rights Reserved 2025
					</div>
				</footer>
			</div>
			<div class="app-body-main-content">
				<section class="service-section">
					<h2>Your Product</h2>
					<div class="service-section-header">
					</div>
					<div class="mobile-only">
						<button class="flat-button">
							Toggle search
						</button>
					</div>
                    <div class="card-wapper">
                        <div class="card1">
                            <div class="product-img">
                                <div class="img-display">
                                    <div class="img-showcase">
                                        <img src="" alt="shoe" id="first_img">
                                        <img src="" alt="shoe" id="second_img">
                                        <img src="" alt="shoe" id="third_img">
                                        <img src="" alt="shoe" id="fourth_img">
                                        <img src="" alt="shoe" id="fifth_img">
                                    </div>
                                </div>
                                <div class="img-select">
                                    <div class="img-item">
                                        <a href="#" data-id="1">
                                            <img src="" alt="shoe" id="first">
                                        </a>
                                    </div>
                                    <div class="img-item">
                                        <a href="#" data-id="2">
                                            <img src="" alt="shoe" id="second">
                                        </a>
                                    </div>
                                    <div class="img-item">
                                        <a href="#" data-id="3">
                                            <img src="" alt="shoe" id="third">
                                        </a>
                                    </div>
                                    <div class="img-item">
                                        <a href="#" data-id="4">
                                            <img src="" alt="shoe" id="fourth">
                                        </a>
                                    </div>
                                    <div class="img-item">
                                        <a href="#" data-id="5">
                                            <img src="" alt="shoe" id="fifth">
                                        </a>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="product-content">
                                <h2 class="product-tittle" id="productname">Nike shoe</h2>
                                <div class="product-ratting">
									<p class="last-price">Product Table Id: <span id="tabid" style="text-decoration: none; color: #256eff;"></span></p>
                                    <p class="new-price">Product Id: <span id="productid"></span></p>
                                </div>
                                <div class="product-price">
                                    <p class="last-price">Old Price: <span id="oldprice"></span></p>
                                    <p class="new-price">New Price: <span id="offerprice" style="font-weight: bold;"></span></p>
                
                                </div>
                                <div class="product-detail">
                                    <h2>Description:</h2>
                                    <p>
                                        Showing a product at a show can involve using product displays, demonstrations, and other techniques to attract customers and promote the product
                                    </p>
                
                                    <ul>
                                        <li>Clour: <span id="colour"></span></li>
                                        <li>Date: <span id="date"></span></li>
                                        <li>Categery: <span id="categery"></span></li>
                                        <li>Gender: <span id="gender"></span></li>
                                        <li>Brand: <span id="brand"></span></li>
										<li>Stock: <span id="stock"></span></li>
										<li>Size: <span id="size"></span></li>
                                    </ul>
                                </div>
                                <div class="purchase-info">
                                    <button type="button" class="btn"  onclick="updateproduct()">Update <i class="fa-solid fa-cart-shopping" style="color: white;"></i></button>
                                    <button type="button" class="btn" onclick="deleteProduct()">Delete <i class="ph ph-trash"></i></button>
                
                                </div>
                            </div>
                        </div>
					<div class="faq">
					</div>
					<div class="payment-section-footer">
					</div>
				</section>
			</div>
			<div class="app-body-sidebar">
			</div>   
		</div>
	</div>
    <script>
        const imgs = document.querySelectorAll('.img-select a');
        const imgBtns = [...imgs];
        let imgId = 1;
        
        imgBtns.forEach((imgItem) => {
            imgItem.addEventListener('click', (event) => {
                event.preventDefault();
                imgId = imgItem.dataset.id;
                slideImage();
            });
        });
        
        function slideImage(){
            const displayWidth = document.querySelector('.img-showcase img:first-child').clientWidth;
        
            document.querySelector('.img-showcase').style.transform = `translateX(${- (imgId - 1) * displayWidth}px)`;
        }
        
        window.addEventListener('resize', slideImage);
    </script>
    
    <script>
    const params = new URLSearchParams(window.location.search);
    const productId = params.get("id");
   // const productId = 81;

    if (productId) {
        fetch(`/getProduct/${productId}`)
            .then(response => {
                if (!response.ok) {
                    throw new Error(`Error: ${response.status} - ${response.statusText}`);
                }
                return response.json();
            })
            .then(data => {
                console.log("Fetched product data:", data);
                
                
                var colorElement = document.getElementById("colour"); // Ensure the element exists
                var dateElement = document.getElementById("date");
                var catElement = document.getElementById("categery");
                var genderElement = document.getElementById("gender");
                var brandElement = document.getElementById("brand");
                var stockElement = document.getElementById("stock");
                var sizeElement = document.getElementById("size");
                
               
                
                var nameElement = document.getElementById("productname");
                var tidElement = document.getElementById("tabid");
                var productidElement = document.getElementById("productid");
                var oldElement = document.getElementById("oldprice");
                var offerElement = document.getElementById("offerprice");
                
                
                var firstimg = document.getElementById("first_img");
                var secondimg = document.getElementById("second_img");
                var thirdimg = document.getElementById("third_img");
                var fourthimg = document.getElementById("fourth_img");
                var fifthimg = document.getElementById("fifth_img");
                
                var first = document.getElementById("first");
                var second = document.getElementById("second");
                var third = document.getElementById("third");
                var fourth = document.getElementById("fourth");
                var fifth = document.getElementById("fifth");


                

                firstimg.src = `/getProductImage/${productId}`;
                first.src = `/getProductImage/${productId}`;
                secondimg.src = `/getProductImage2/${productId}`;
                second.src = `/getProductImage2/${productId}`;
                thirdimg.src = `/getProductImage3/${productId}`;
                third.src = `/getProductImage3/${productId}`;
                fourthimg.src = `/getProductImage4/${productId}`;
                fourth.src = `/getProductImage4/${productId}`;
                fifthimg.src = `/getProductImage5/${productId}`;
                fifth.src = `/getProductImage5/${productId}`;
                
                
                nameElement.textContent = data.product_name || "N/A"; // Use `color`, not `colour`
                tidElement.textContent = data.id || "N/A";
                productidElement.textContent = data.product_id || "N/A";
                oldElement.textContent = data.old_price || "N/A";
                offerElement.textContent = data.offer_price || "N/A";
                
                colorElement.textContent = data.color || "N/A"; // Use `color`, not `colour`
                dateElement.textContent = data.date || "N/A";
                catElement.textContent = data.category || "N/A";
                genderElement.textContent = data.gender || "N/A";
                brandElement.textContent = data.brand || "N/A";
                stockElement.textContent = data.stock_quantity || "N/A";
                sizeElement.textContent = data.size || "N/A";
                
               
                
                
            })
            .catch(error => console.error("Error fetching product:", error));
    }    
    
    
    function deleteProduct() {
    	const Id = productId;
        if (confirm('Are you sure you want to delete this product?')) {
        	console.log(Id);

        	var int_id = parseInt(Id);
        	
        	console.log(int_id);

            fetch(`/productdel/${int_id}`, { method: 'DELETE' })
                .then(response => {
                    if (response.ok) {
                        alert('Product deleted successfully');
                        window.location.href = `product.html`;
                          // Refresh the table after deletion
                    } else {
                        alert('Error deleting product');
                    }
                })
                .catch(error => console.error('Error deleting product:', error));
        }
    }
	
	function updateproduct(){
		window.location.href = `updateproduct.html?id=${productId}`;
	}
    
    let admindata = {};

	  async function fetchAdminInfo() {
	    try {
	      const adminRes = await fetch('/api/admininfo');

	      if (!adminRes.ok) {
	        throw new Error('Failed to fetch admin info');
	      }

	      const data = await adminRes.json();

	      
	      // Update DOM
	      document.getElementById("adminname").innerText = data.name;
	      document.getElementById("adminimg").src = `/api/getAdminImage/${data.id}`;

	      console.log("Admin Data:", data);

	    } catch (error) {
	      console.error('Error fetching admin data:', error.message);
	    }
	  }

	  // Call function on load
	  fetchAdminInfo();
	
    </script>
</body>
</html>

